json {
  skip_on_invalid_json => true
  source => "labels"
  tag_on_failure => "labels_not_json"
  target => "parseLabels"
}

ruby {
  code => "
      labels = event.get('parseLabels')
      labels.each do |key, value|
        key.gsub!('/', '_')
        key.gsub!('.', '_')
        event.set(key, value)
      end
      event.remove('parseLabels')
  "
}